<img src="https://r2cdn.perplexity.ai/pplx-full-logo-primary-dark%402x.png" style="height:64px;margin-right:32px"/>

# Спасибо! А структуру главной страницы можешь подготовить, для AI?

Можно описать главную страницу как JSON‑спецификацию с блоками layout, datasets, filters и widgets, чтобы другой AI или генератор интерфейсов мог по ней собрать дашборд.[^1][^2]

## Формат описания

Ниже один JSON‑объект `dashboard_spec`, в котором заданы источники данных (наши мок‑датасеты), фильтры и виджеты с привязкой к датасетам и полям, соответствующим витринам FCT_PAYMENTS и FCT_RDM_IPS.[^2][^1]
Такую структуру можно скормить AI, который умеет по описанию `type`, `bindings` и `layout` строить компоненты (карточки KPI, графики, таблицы).[^1]

## JSON спецификация страницы

```json
{
  "id": "payments_main_dashboard",
  "title": "Мониторинг платежей",
  "layout": {
    "type": "vertical",
    "sections": [
      {
        "id": "filters_bar",
        "type": "horizontal",
        "height": "auto",
        "widgets": ["filter_period", "filter_currency", "filter_status", "filter_mcc"]
      },
      {
        "id": "kpi_row",
        "type": "horizontal",
        "height": "small",
        "widgets": ["kpi_total_amount", "kpi_total_count", "kpi_rejected_share", "kpi_active_clients", "kpi_avg_proc_time"]
      },
      {
        "id": "main_row",
        "type": "horizontal",
        "height": "flex",
        "columns": [
          {
            "id": "col_left",
            "width": "60%",
            "widgets": ["chart_timeseries", "chart_status_funnel"]
          },
          {
            "id": "col_right",
            "width": "40%",
            "widgets": ["chart_top_clients", "chart_mcc"]
          }
        ]
      }
    ]
  },
  "datasets": {
    "kpi_summary": {
      "source": "mock/kpi_summary.json",
      "primaryKey": "period_label"
    },
    "timeseries_daily": {
      "source": "mock/timeseries_daily.json",
      "primaryKey": ["date", "status"]
    },
    "status_overview": {
      "source": "mock/status_overview.json",
      "primaryKey": "stage"
    },
    "top_clients": {
      "source": "mock/top_clients.json",
      "primaryKey": ["role", "client_account"]
    },
    "mcc_summary": {
      "source": "mock/mcc_summary.json",
      "primaryKey": "mcc"
    }
  },
  "filters": [
    {
      "id": "filter_period",
      "type": "date_range",
      "label": "Период",
      "bindings": {
        "datasets": {
          "timeseries_daily": "date",
          "kpi_summary": ["date_from", "date_to"]
        }
      }
    },
    {
      "id": "filter_currency",
      "type": "select",
      "label": "Валюта",
      "multi": true,
      "valuesSource": "static",
      "values": ["RUB", "USD", "EUR"],
      "bindings": {
        "datasets": {
          "timeseries_daily": "currency",
          "top_clients": "currency",
          "mcc_summary": "currency"
        }
      }
    },
    {
      "id": "filter_status",
      "type": "select",
      "label": "Статус",
      "multi": true,
      "valuesSource": "fromDataset",
      "valuesDataset": "timeseries_daily",
      "valuesField": "status",
      "bindings": {
        "datasets": {
          "timeseries_daily": "status",
          "status_overview": "status_code"
        }
      }
    },
    {
      "id": "filter_mcc",
      "type": "select",
      "label": "MCC",
      "multi": true,
      "valuesSource": "fromDataset",
      "valuesDataset": "mcc_summary",
      "valuesField": "mcc",
      "bindings": {
        "datasets": {
          "mcc_summary": "mcc",
          "top_clients": "mcc"
        }
      }
    }
  ],
  "widgets": [
    {
      "id": "kpi_total_amount",
      "type": "kpi",
      "title": "Сумма операций",
      "dataset": "kpi_summary",
      "valueField": "total_amount",
      "format": "currency"
    },
    {
      "id": "kpi_total_count",
      "type": "kpi",
      "title": "Количество операций",
      "dataset": "kpi_summary",
      "valueField": "total_count",
      "format": "integer"
    },
    {
      "id": "kpi_rejected_share",
      "type": "kpi",
      "title": "Доля отказов, %",
      "dataset": "kpi_summary",
      "valueField": "rejected_share_pct",
      "format": "percent"
    },
    {
      "id": "kpi_active_clients",
      "type": "kpi",
      "title": "Активные клиенты",
      "dataset": "kpi_summary",
      "valueField": "active_clients_count",
      "format": "integer"
    },
    {
      "id": "kpi_avg_proc_time",
      "type": "kpi",
      "title": "Среднее время обработки, сек",
      "dataset": "kpi_summary",
      "valueField": "avg_proc_time_sec",
      "format": "number"
    },
    {
      "id": "chart_timeseries",
      "type": "line_chart",
      "title": "Динамика платежей",
      "dataset": "timeseries_daily",
      "xField": "date",
      "series": [
        {
          "name": "Успешные",
          "valueField": "trx_amount",
          "filter": { "status": "SUCCESS" }
        },
        {
          "name": "Отклонённые",
          "valueField": "trx_amount",
          "filter": { "status": "REJECTED" }
        }
      ],
      "options": {
        "stacked": false,
        "showLegend": true
      }
    },
    {
      "id": "chart_status_funnel",
      "type": "funnel",
      "title": "Воронка обработки",
      "dataset": "status_overview",
      "stageField": "stage",
      "valueField": "trx_count"
    },
    {
      "id": "chart_top_clients",
      "type": "bar_chart",
      "title": "Топ клиентов по сумме",
      "dataset": "top_clients",
      "xField": "client_name",
      "yField": "trx_amount",
      "groupField": "role",
      "options": {
        "orientation": "horizontal",
        "topN": 10
      }
    },
    {
      "id": "chart_mcc",
      "type": "bar_chart",
      "title": "Обороты по MCC",
      "dataset": "mcc_summary",
      "xField": "mcc",
      "yField": "trx_amount",
      "options": {
        "orientation": "vertical",
        "topN": 15
      }
    }
  ]
}
```


## Виджеты и поля

Все KPI‑виджеты читают агрегаты из `kpi_summary`, которые логически соответствуют суммам и количествам по INSTR_AMOUNT, INSTR_COUNT и признакам отказа из FCT_PAYMENTS.[^1]
Графики и воронка используют `timeseries_daily` и `status_overview`, которые отражают динамику по VALUE_DATE/ACCEPT_DATE и TRXN_STATUS/FACT_STATUS, а также аналитику по клиентам и MCC через `top_clients` и `mcc_summary`.[^2][^1]

## Как использовать эту структуру

AI‑агенту достаточно объяснить, что нужно создать страницу по объекту `dashboard_spec`: каждый `widget` — это компонент визуализации с указанным типом, данными и биндингами, а `layout` определяет, как компоненты расположить на экране.[^1]
При необходимости можно расширить JSON полями стилей, прав доступа и описаниями, не меняя общую схему `layout + datasets + filters + widgets`.[^2][^1]

<div align="center">⁂</div>

[^1]: FCT_PAYMENTS.tab

[^2]: FCT_RDM_IPS.tab

